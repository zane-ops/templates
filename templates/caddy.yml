x-zane-env:
  DOMAIN: "{{ generate_domain }}"
  IMAGE_VERSION: 2-alpine
services:
  caddy:
    image: caddy:${IMAGE_VERSION:-alpine}
    configs:
      - source: caddyfile
        target: /etc/caddy/Caddyfile
      - source: index.html
        target: /srv/index.html
    volumes:
      - caddy-data:/data
    deploy:
      labels:
        zane.http.routes.0.port: 80
        zane.http.routes.0.domain: ${DOMAIN}

volumes:
  caddy-data:

configs:
  caddyfile:
    content: |
      :80 {
        root * /srv
        file_server
        log
      }
  index.html:
    content: |
      <!DOCTYPE html>
      <html>
      <head>
        <title>Hello from ZaneOps!</title>
        <style>
          body {
            font-family: system-ui, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
          }
          .container {
            text-align: center;
          }
        </style>
      </head>
      <body>
        <div class="container">
          <h1>ðŸ‘‹ Hello from ZaneOps!</h1>
          <p>Your Caddy app is running successfully.</p>
        </div>
      </body>
      </html>
